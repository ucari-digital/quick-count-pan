!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.Default=o():(t.ColorPicker=t.ColorPicker||{},t.ColorPicker.Default=o())}(window,function(){return function(t){var o={};function e(r){if(o[r])return o[r].exports;var s=o[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.l=!0,s.exports}return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,o){if(1&o&&(t=e(t)),8&o)return t;if(4&o&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&o&&"string"!=typeof t)for(var s in t)e.d(r,s,function(o){return t[o]}.bind(null,s));return r},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},e.p="",e(e.s=6)}([function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function t(o,e){if(this.nodes=[],this.pseudoSelector="",this.callbacks={},e||(e=document),"string"==typeof o)if("<"===o[0]&&">"===o[o.length-1])this.nodes=[t.createNode(o)];else{if(-1!==o.search(/(:before|:after)$/gi)){var r=o.match(/(:before|:after)$/gi);o=o.split(r[0])[0],this.pseudoSelector=r[0]}this.nodes=[].slice.call(e.querySelectorAll(o))}else o instanceof NodeList?this.nodes=o.length>1?[].slice.call(o):[o]:(o instanceof HTMLDocument||o instanceof Window||o instanceof HTMLElement)&&(this.nodes=[o])}return t.select=function(o,e){return new t(o,e)},t.create=function(o){return new t(t.createNode(o))},t.prototype.attr=function(t,o){return void 0!=o?(this.each(this.nodes,function(e){e.setAttribute(t,o)}),this):this.getLastNode().getAttribute(t)},t.prototype.append=function(o){var e;return e=o instanceof t?o.get():o,this.each(this.nodes,function(t){t.appendChild(e)}),this},t.prototype.parent=function(){return new t(this.getLastNode().parentNode)},t.prototype.each=function(t,o){t instanceof Function&&(o=t,t=this.nodes);for(var e=0;e<t.length;e++)o.call(this.nodes[e],this.nodes[e],e);return this},t.prototype.hasClass=function(t){return this.getLastNode().classList.contains(t)},t.prototype.addClass=function(t){if(t){var o=t.split(" ");this.each(this.nodes,function(t){for(var e in o)t.classList.add(o[e])})}return this},t.prototype.removeClass=function(t){var o=t.split(" ");return this.each(this.nodes,function(t){for(var e in o)t.classList.remove(o[e])}),this},t.prototype.find=function(o){return new t(o,this.getLastNode())},t.prototype.trigger=function(t,o){var e=new CustomEvent(t,{detail:o});return this.each(this.nodes,function(t){t.dispatchEvent(e)}),this},t.prototype.text=function(t){return this.each(this.nodes,function(o){o.innerText=t}),this},t.prototype.css=function(o,e){if(void 0===e){var r=this.getLastNode(),s=null;if(o=t.convertToJsProperty(o),"function"!=typeof r.getBoundingClientRect||this.pseudoSelector||(s=r.getBoundingClientRect()[o]),!s){var i=getComputedStyle(r,this.pseudoSelector)[o];i.search("px")&&(s=parseInt(i,10))}if(isNaN(s))throw"Undefined css property: "+o;return s}return this.nodes.length>1?this.each(this.nodes,function(t){t.style[o]=e}):this.nodes[0].style[o]=e,this},t.prototype.on=function(t,o){var e=this;return this.each(this.nodes,function(r){var s=function(t){o.call(r,t)};e.callbacks[t]=s,r.addEventListener(t,s)}),this},t.prototype.off=function(t){var o=this.callbacks[t];return this.each(this.nodes,function(e){e.removeEventListener(t,o,!1)}),this},t.prototype.val=function(t){return void 0===t?this.getLastNode().value:(this.each(this.nodes,function(o){o.value=t}),this)},t.prototype.is=function(t){return this.getLastNode().tagName.toLowerCase()===t},t.prototype.get=function(t){return void 0===t&&(t=0),this.nodes[t]},t.prototype.length=function(){return this.nodes.length},t.prototype.hide=function(){return this.each(this.nodes,function(o){t.select(o).css("display","none")}),this},t.prototype.show=function(){return this.each(this.nodes,function(o){t.select(o).css("display","")}),this},t.prototype.empty=function(){return this.each(this.nodes,function(o){t.select(o).get().innerHTML=""}),this},t.prototype.remove=function(){this.each(this.nodes,function(t){t.remove()})},t.prototype.insertBefore=function(t){var o=this.resolveElement(t);return this.each(this.nodes,function(t){t.parentNode.insertBefore(o,o.previousSibling)}),this},t.prototype.insertAfter=function(t){var o=this.resolveElement(t);return this.each(this.nodes,function(t){t.parentNode.insertBefore(o,t.nextSibling)}),this},t.prototype.resolveElement=function(o){var e;return t.isHtml(o)?e=t.createNode(o):o instanceof HTMLElement?e=o:o instanceof t&&(e=o.get()),e},t.prototype.closest=function(o){return t.select(this.getLastNode().closest(o))},t.prototype.data=function(t){return this.attr("data-"+t)},t.prototype.width=function(t){return void 0!==t?(this.css("width",t),this):this.getLastNode()===window?parseInt(this.getLastNode().innerWidth,10):parseInt(this.css("width"),10)},t.prototype.height=function(t){return void 0!==t?(this.css("height",t),this):this.getLastNode()===window?parseInt(this.getLastNode().innerHeight,10):parseInt(this.css("height"),10)},t.prototype.position=function(){return{top:Number(this.getLastNode().getBoundingClientRect().top),bottom:Number(this.getLastNode().getBoundingClientRect().bottom),left:Number(this.getLastNode().getBoundingClientRect().left),right:Number(this.getLastNode().getBoundingClientRect().right)}},t.prototype.offset=function(){return{top:Number(this.getLastNode().offsetTop),left:Number(this.getLastNode().offsetLeft)}},t.createNode=function(t){if("<"===t[0]&&">"===t[t.length-1]){var o=document.createElement("div");return o.innerHTML=t,o.firstChild}return document.createElement(t)},t.isHtml=function(t){return"<"===t[0]&&">"===t[t.length-1]},t.convertToJsProperty=function(t){return(t=(t=(t=t.toLowerCase().replace("-"," ")).replace(/(^| )(\w)/g,function(t){return t.toUpperCase()})).charAt(0).toLowerCase()+t.slice(1)).replace(" ","")},t.prototype.getLastNode=function(){return this.nodes[this.nodes.length-1]},t}();o.TsDom=r},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e(0),s=function(){function t(t){this.color=t,this.normalize()}return t.prototype.normalize=function(){var t=1;if(this.color.match(/^rgba/g)){var o=this.color.split("(")[1].split(")")[0].split(",");this.color="rgb("+o[0]+", "+o[1]+", "+o[2]+")",t=+o[3]}var e=r.TsDom.create("canvas").get().getContext("2d");e.clearRect(0,0,1,1),e.fillStyle=this.color,e.fillRect(0,0,1,1);var s=e.getImageData(0,0,1,1).data,i=s[0],n=s[1],a=s[2],c=a|n<<8|i<<16,h=this.rgbaToHsla(i,n,a,t);this.rgb="rgb("+i+", "+n+", "+a+")",this.rgba="rgba("+i+", "+n+", "+a+", "+t+")",this.hex="#"+(16777216+c).toString(16).slice(1),this.hsl="hsl("+h.h+", "+h.s+"%, "+h.l+"%)",this.hsla="hsla("+h.h+", "+h.s+"%, "+h.l+"%, "+t+")",this.source={rgba:{r:i,g:n,b:a,a:t},hsla:{h:h.h,s:h.s,l:h.l,a:h.a}}},t.prototype.format=function(t){return"rgb"===t?this.rgb:"rgba"===t?this.rgba:"hex"===t?this.hex:"hsl"===t?this.hsl:"hsla"===t?this.hsla:"source"===t?this.source:this.hex},t.prototype.setOpacity=function(t){this.rgba="rgba("+this.source.rgba.r+", "+this.source.rgba.g+", "+this.source.rgba.b+", "+t+")",this.hsla="hsla("+this.source.hsla.h+", "+this.source.hsla.s+"%, "+this.source.hsla.l+"%, "+t+")",this.source.rgba.a=t,this.source.hsla.a=t},t.prototype.isValid=function(){return!("#000000"===this.hex&&"#000"!==this.color&&"#000000"!==this.color&&"black"!==this.color)},t.prototype.rgbaToHsla=function(t,o,e,r){t/=255,o/=255,e/=255;var s,i,n=Math.max(t,o,e),a=Math.min(t,o,e),c=(n+a)/2;if(n==a)s=i=0;else{var h=n-a;switch(i=c>.5?h/(2-n-a):h/(n+a),n){case t:s=(o-e)/h+(o<e?6:0);break;case o:s=(e-t)/h+2;break;case e:s=(t-o)/h+4}s/=6}return{h:Math.ceil(100*s),s:Math.ceil(100*i),l:Math.ceil(100*c),a:r}},t.process=function(o){return new t(o)},t}();o.Color=s},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e(0),s=function(){function t(t,o,e,s){this.selector=t,this.picker=o,this.defaultPlacement=e,this.arrow=s;var i=this,n=this.getScrollParent(this.selector.get());this.processHandler=function(t){return i.process()},this.scrollParent=r.TsDom.select(n),this.scrollParent.on("scroll",this.processHandler),this.window=r.TsDom.select(window),this.window.on("scroll",this.processHandler)}return t.prototype.process=function(){var t=this.picker.attr("id"),o=r.TsDom.select("#"+t+":after"),e=o.width(),s=o.height(),i=this.selector.width(),n=this.selector.height(),a=this.selector.position().top,c=this.selector.position().left,h=this.picker.width(),l=this.picker.height(),p="bottom",u=this.defaultPlacement.split("-"),d=e/2;if("bottom"===(p=u.length>1?u[0]:this.defaultPlacement)){var f=a+n+s,C=0;if(c+h<r.TsDom.select(window).width())C=c,this.picker.removeClass("is-arrow-right").addClass("is-arrow-left"),i<(g=o.css("left"))+o.width()+Math.ceil(g/2)&&(C-=Math.ceil(g+d/2-i/2));else C=c+i-h,this.picker.removeClass("is-arrow-left").addClass("is-arrow-right"),i<(v=o.css("right"))+o.width()+Math.ceil(v/2)&&(C=C+3+(v+d/2-i/2));this.picker.css("top",f+"px"),this.picker.css("left",C+"px")}else if("top"===p){var g,v;f=a-l-s,C=0;if(c+h<r.TsDom.select(window).width())C=c,this.picker.css("left",C+"px"),this.picker.removeClass("is-arrow-right").addClass("is-arrow-left"),i<(g=o.css("left"))+o.width()+Math.ceil(g/2)&&(C-=Math.ceil(g+d/2-i/2));else C=c+i-h,this.picker.removeClass("is-arrow-left").addClass("is-arrow-right"),i<(v=o.css("right"))+o.width()+Math.ceil(v/2)&&(C=C+3+(v+d/2-i/2));this.picker.css("top",f+"px"),this.picker.css("left",C+"px")}else if("left"===p){f=a,C=c-h-e;if(a+l<r.TsDom.select(window).height())this.picker.removeClass("is-arrow-bottom").addClass("is-arrow-top"),n<(m=o.css("top"))+s+Math.ceil(m/2)&&(f-=Math.ceil(m+d/2-n/2));else f=a+n-l,this.picker.removeClass("is-arrow-top").addClass("is-arrow-bottom"),n<(y=o.css("bottom"))+o.height()+Math.ceil(y/2)&&(f=f+4+(y+d/2-n/2));this.picker.css("top",f+"px"),this.picker.css("left",C+"px")}else if("right"===p){var m,y;f=a,C=c+i+e;if(a+l<r.TsDom.select(window).height())this.picker.removeClass("is-arrow-bottom").addClass("is-arrow-top"),n<(m=o.css("top"))+s+Math.ceil(m/2)&&(f-=Math.ceil(m+d/2-n/2));else f=a+n-l,this.picker.removeClass("is-arrow-top").addClass("is-arrow-bottom"),n<(y=o.css("bottom"))+o.height()+Math.ceil(y/2)&&(f=f+4+(y+d/2-n/2));this.picker.css("top",f+"px"),this.picker.css("left",C+"px")}},t.prototype.destroy=function(){this.scrollParent.off("scroll"),this.window.off("scroll")},t.prototype.getScrollParent=function(t){var o=/(auto|scroll)/,e=function(t,o){return null===t.parentNode?o:e(t.parentNode,o.concat([t]))},r=function(t,o){return getComputedStyle(t,null).getPropertyValue(o)},s=function(t){return o.test(function(t){return r(t,"overflow")+r(t,"overflow-y")+r(t,"overflow-x")}(t))};return function(t){if(t instanceof HTMLElement||t instanceof SVGElement){for(var o=e(t.parentNode,[]),r=0;r<o.length;r+=1)if(s(o[r]))return o[r];return document.scrollingElement||document.documentElement}}(t)},t}();o.PickerPosition=s},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o._uniqueId=function(t){return void 0===t&&(t=16),Math.random().toString(36).substr(2,t)}},function(t,o,e){t.exports=function(){"use strict";var t=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===o}(t)}(t)},o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function e(o,e){var r=!e||!1!==e.clone;return r&&t(o)?s(function(t){return Array.isArray(t)?[]:{}}(o),o,e):o}function r(t,o,r){return t.concat(o).map(function(t){return e(t,r)})}function s(o,i,n){var a=Array.isArray(i),c=Array.isArray(o),h=n||{arrayMerge:r},l=a===c;if(l){if(a){var p=h.arrayMerge||r;return p(o,i,n)}return function(o,r,i){var n={};return t(o)&&Object.keys(o).forEach(function(t){n[t]=e(o[t],i)}),Object.keys(r).forEach(function(a){t(r[a])&&o[a]?n[a]=s(o[a],r[a],i):n[a]=e(r[a],i)}),n}(o,i,n)}return e(i,n)}return s.all=function(t,o){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,e){return s(t,e,o)},{})},s}()},function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var r=e(0),s=e(4),i=e(3),n=e(2),a=function(){function t(o,e){void 0===e&&(e={}),this.options={color:"",inline:!1,placement:"bottom",format:"rgba",customClass:"",size:"default",arrow:!0,anchor:{hidden:!1,cssProperty:"color"},animation:"slide-in",hideInfo:!1,history:{hidden:!1,placeholdersAmount:10,colors:[]}},this.events={change:function(t){}};this.anchor=r.TsDom.select(o),this.id="colorpicker-"+i._uniqueId(),this.anchorId=this.id+"-anchor",this.cssId="#"+this.id,this.cssAnchorId="#"+this.anchorId,this.options=s.all([this.options,this.getDefaultOptions(),t.globalOptions,e],{arrayMerge:function(t,o,e){return o}}),this.document=r.TsDom.select(document),this.initPicker(),this.update(),this.initAnchor()}return t.prototype.setColor=function(t){this.options.color=t,this.update()},t.prototype.show=function(){this.bindCommonEvents(),this.picker.removeClass(this.options.animation).addClass(this.options.animation).addClass("is-opened").addClass("colorpicker--position-"+this.options.placement),this.detectPickerPosition()},t.prototype.hide=function(){this.picker.hasClass("is-opened")&&(this.pickerPosition.destroy(),this.unBindCommonEvents(),this.picker.removeClass("is-opened"),this.anchor.get(0).blur())},t.prototype.destroy=function(){},t.prototype.unBindCommonEvents=function(){this.options.inline||this.document.off("mousedown")},t.prototype.on=function(t,o){this.events[t]=o},t.prototype.setAnchorCssProperty=function(t){this.options.anchor.cssProperty=t},t.prototype.setPlacement=function(t){this.options.placement=t},t.setGlobalOptions=function(o){t.globalOptions=o},t.prototype.initPicker=function(){this.buildLayout(),this.picker.addClass(this.getPickerCssClassName()+"--size-"+this.options.size),this.options.arrow||this.picker.addClass("colorpicker--no-arrow"),this.addCustomClass(),this.options.inline?(this.anchor.parent().hasClass("colorpicker-input")?this.anchor.parent().insertAfter(this.picker):this.anchor.insertAfter(this.picker),this.anchor.addClass("colorpicker-anchor--inline"),this.picker.addClass("colorpicker--inline")):r.TsDom.select("body").append(this.picker),this.bindEvents()},t.prototype.bindCommonEvents=function(){var t=this;this.options.inline||this.document.on("click",function(o){var e=r.TsDom.select(o.target).closest(".colorpicker");e.length()&&e.attr("id")===t.picker.attr("id")||o.target===t.anchor.get(0)||t.hide()})},t.prototype.initAnchor=function(){var t=this,o=this,e=function(t){o.hideAllActivePickers(),o.show(),t.stopPropagation()};if(this.anchor.addClass("colorpicker-anchor"),this.options.anchor.hidden&&this.anchor.hide(),this.anchor.is("input")){this.anchor.val(o.getColor().toString()).on("input",function(o){t.setColor(t.anchor.val())});var r=this.anchor.parent().find("[data-color]");r.length()&&r.css("background",o.getColor()),this.options.inline||this.anchor.on("focus",e)}else this.anchor.find("[data-color]").length()?this.anchor.find("[data-color]").css("background",o.getColor()):this.anchor.css(o.options.anchor.cssProperty,o.getColor()),this.options.inline||this.anchor.on("click",e);this.picker.on("colorpicker:color-change",function(e){o.options.hideAfterColorChange&&!t.options.inline&&o.hide();var r=null;t.anchor.val(o.getColor().toString()),(r=t.anchor.parent().hasClass("colorpicker-input")?t.anchor.parent().find("[data-color]"):t.anchor.find("[data-color]")).length()?r.css("background-color",o.getColor()):t.anchor.is("input")||t.anchor.css(o.options.anchor.cssProperty,o.getColor()),t.events.change.apply(o,[o.getColorObject()])}),this.picker.on("colorpicker:hide",function(o){t.hide()})},t.prototype.hideAllActivePickers=function(){r.TsDom.select(".colorpicker.is-opened:not("+this.cssId+"):not(.colorpicker--inline)").trigger("colorpicker:hide")},t.prototype.addCustomClass=function(){this.picker.addClass(this.options.customClass)},t.prototype.detectPickerPosition=function(){var t=this;this.pickerPosition=new n.PickerPosition(this.anchor,this.picker,this.options.placement,this.options.arrow),this.pickerPosition.process(),this.picker.on("colorpicker:refresh-position",function(o){t.pickerPosition.process()})},t.prototype.dispatchColorChangedEvent=function(){this.picker.trigger("colorpicker:color-change",{color:this.getColor()})},t.prototype.dispatchRefreshPositionEvent=function(){this.picker.trigger("colorpicker:refresh-position")},t.globalOptions={},t}();o.ColorPicker=a},function(t,o,e){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),s=e(5),i=e(1),n=e(0),a=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return r(o,t),o.prototype.buildLayout=function(){var t=this;this.picker=n.TsDom.create("div").addClass("colorpicker").addClass("colorpicker-default").attr("id",this.id);var o=n.TsDom.create("div").addClass("colorpicker-default__body"),e=n.TsDom.create("div").addClass("colorpicker-default__info");this.options.hideInfo&&e.addClass("colorpicker-default__info--hidden"),this.spectrumContainer=n.TsDom.create("div").addClass("colorpicker-default__spectrum-container"),this.spectrumCanvas=n.TsDom.create("canvas").addClass("colorpicker-default__spectrum-canvas"),this.spectrumCursor=n.TsDom.create("div").addClass("colorpicker-default__spectrum-cursor"),this.spectrumContainer.append(this.spectrumCanvas).append(this.spectrumCursor),this.hueContainer=n.TsDom.create("div").addClass("colorpicker-default__hue-container"),this.hueCanvas=n.TsDom.create("canvas").addClass("colorpicker-default__hue-canvas"),this.hueCursor=n.TsDom.create("div").addClass("colorpicker-default__hue-cursor"),this.hueContainer.append(this.hueCanvas).append(this.hueCursor),this.opacityContainer=n.TsDom.create("div").addClass("colorpicker-default__opacity-container"),this.opacityCanvas=n.TsDom.create("canvas").addClass("colorpicker-default__opacity-canvas"),this.opacityCursor=n.TsDom.create("div").addClass("colorpicker-default__opacity-cursor");var r=n.TsDom.create("div").addClass("colorpicker-default__hex-input-container"),s=n.TsDom.create("div").addClass("colorpicker-default__hex-text").text("hex");this.hexInput=n.TsDom.create("input").addClass("colorpicker-default__hex-input").attr("maxlength",7),r.append(this.hexInput).append(s);var a=n.TsDom.create("div").addClass("colorpicker-default__r-input-container"),c=n.TsDom.create("div").addClass("colorpicker-default__r-text").text("r");this.rInput=n.TsDom.create("input").addClass("colorpicker-default__r-input").attr("maxlength",3),a.append(this.rInput).append(c);var h=n.TsDom.create("div").addClass("colorpicker-default__g-input-container"),l=n.TsDom.create("div").addClass("colorpicker-default__g-text").text("g");this.gInput=n.TsDom.create("input").addClass("colorpicker-default__g-input").attr("maxlength",3),h.append(this.gInput).append(l);var p=n.TsDom.create("div").addClass("colorpicker-default__b-input-container"),u=n.TsDom.create("div").addClass("colorpicker-default__b-text").text("b");this.bInput=n.TsDom.create("input").addClass("colorpicker-default__b-input").attr("maxlength",3),p.append(this.bInput).append(u);var d=n.TsDom.create("div").addClass("colorpicker-default__a-input-container");this.aInput=n.TsDom.create("input").addClass("colorpicker-default__a-input").attr("maxlength",4);var f=n.TsDom.create("div").addClass("colorpicker-default__a-text").text("a");d.append(this.aInput).append(f),this.history=n.TsDom.create("div").addClass("colorpicker-default__history"),this.options.history.hidden&&this.history.addClass("is-hidden");var C=n.TsDom.create("div").addClass("colorpicker-default__history-item").addClass("is-add-new");this.history.append(C),this.options.history.colors.forEach(function(o){var e=n.TsDom.create("div").addClass("colorpicker-default__history-item").addClass("has-color").css("background",o).attr("data-history-color",new i.Color(o).rgba);t.history.append(e)});for(var g=0;g<this.options.history.placeholdersAmount-this.options.history.colors.length;g++){var v=n.TsDom.create("div").addClass("colorpicker-default__history-item").addClass("is-empty").attr("data-history-color","");this.history.append(v)}this.opacityContainer.append(this.opacityCanvas).append(this.opacityCursor),o.append(this.spectrumContainer).append(this.hueContainer).append(this.opacityContainer),e.append(r).append(a).append(h).append(p).append(d),this.picker.append(o).append(e).append(this.history)},o.prototype.bindEvents=function(){var t=this,o=this;this.spectrumCursor.on("dragstart",function(t){t.stopPropagation(),t.preventDefault()}),this.spectrumContainer.on("mousedown",function(e){1==e.which&&(t.initDragObject(e,o.spectrumCursor,o.spectrumCanvas),t.processCursorPosition(t.spectrumCursor,t.spectrumCanvas,t.dragObject.shiftX,t.dragObject.shiftY),t.spectrumColor=t.setCursorColorFromCursorPosition(t.spectrumCursor,t.spectrumCanvas,t.dragObject.shiftX,t.dragObject.shiftY),t.setOpacityGradientAndCursorColor(),t.setColorValuesToInputs(),t.dispatchColorChangedEvent())}),this.hueContainer.on("mousedown",function(e){if(1==e.which){t.initDragObject(e,t.hueCursor,t.hueCanvas),t.dragObject.processShiftX=!1,t.processCursorPosition(o.hueCursor,o.hueCanvas,o.dragObject.shiftX,o.dragObject.shiftY,o.dragObject.processShiftX),t.hueColor=t.setCursorColorFromCursorPosition(o.hueCursor,o.hueCanvas,o.dragObject.shiftX,o.dragObject.shiftY),t.fillSpectrumCanvas();var r=t.getCursorCoords(t.spectrumCursor);t.spectrumColor=t.setCursorColorFromCursorPosition(o.spectrumCursor,o.spectrumCanvas,r.shiftX,r.shiftY),t.fillOpacityCanvas(),t.setOpacityGradientAndCursorColor(),t.setColorValuesToInputs(),t.dispatchColorChangedEvent()}}),this.opacityContainer.on("mousedown",function(e){1==e.which&&(t.initDragObject(e,t.opacityCursor,t.opacityCanvas),t.dragObject.processShiftX=!1,t.processCursorPosition(o.opacityCursor,o.opacityCanvas,o.dragObject.shiftX,o.dragObject.shiftY,o.dragObject.processShiftX),t.changeAInputValue(o.dragObject.shiftY),t.setCursorColorFromCursorPosition(o.opacityCursor,o.opacityCanvas,o.dragObject.shiftX,o.dragObject.shiftY,+t.aInput.val()),t.dispatchColorChangedEvent())}),this.hexInput.on("keyup",function(o){var e=t.hexInput.val();/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)&&(t.spectrumColor=i.Color.process(e),t.setHueCursorPosition(),t.fillSpectrumCanvas(),t.fillOpacityCanvas(),t.spectrumColor=t.setSpectrumCursorPositionByColor(t.spectrumColor),t.setOpacityGradientAndCursorColor(),t.rInput.val(t.spectrumColor.source.rgba.r),t.gInput.val(t.spectrumColor.source.rgba.g),t.bInput.val(t.spectrumColor.source.rgba.b),t.dispatchColorChangedEvent())}),this.rInput.on("keyup",function(o){t.onChangeInputValue(t.rInput)}),this.gInput.on("keyup",function(o){t.onChangeInputValue(t.gInput)}),this.bInput.on("keyup",function(o){t.onChangeInputValue(t.bInput)}),this.aInput.on("keyup",function(o){var e=t.aInput.val();e.match(/^\d*(\.\d+)?$/)&&e>=0&&e<=1&&(t.setOpacityCursorPosition(e),t.dispatchColorChangedEvent())}),n.TsDom.select(document).on("mousemove",function(e){if(t.dragObject){var r=t.dragObject.shiftX,s=t.dragObject.shiftY;if(t.dragObject.processShiftX)r=e.clientX-t.dragObject.downX+t.dragObject.shiftX;if(t.dragObject.processShiftY)s=e.clientY-t.dragObject.downY+t.dragObject.shiftY;if(t.processCursorPosition(t.dragObject.elements.cursor,t.dragObject.elements.canvas,r,s,t.dragObject.processShiftX,t.dragObject.processShiftY),t.dragObject.elements.cursor.hasClass("colorpicker-default__spectrum-cursor"))t.spectrumColor=t.setCursorColorFromCursorPosition(t.spectrumCursor,t.spectrumCanvas,r,s),t.setOpacityGradientAndCursorColor(),t.setColorValuesToInputs(),t.dispatchColorChangedEvent();else if(t.dragObject.elements.cursor.hasClass("colorpicker-default__hue-cursor")){t.hueColor=t.setCursorColorFromCursorPosition(o.hueCursor,o.hueCanvas,r,s),t.fillSpectrumCanvas();var i=t.getCursorCoords(t.spectrumCursor);t.spectrumColor=t.setCursorColorFromCursorPosition(o.spectrumCursor,o.spectrumCanvas,i.shiftX,i.shiftY),t.fillOpacityCanvas(),t.setOpacityGradientAndCursorColor(),t.setColorValuesToInputs(),t.dispatchColorChangedEvent()}else t.dragObject.elements.cursor.hasClass("colorpicker-default__opacity-cursor")&&(t.changeAInputValue(s),t.setCursorColorFromCursorPosition(o.opacityCursor,o.opacityCanvas,r,s,+t.aInput.val()),t.dispatchColorChangedEvent())}}).on("mouseup",function(o){t.dragObject=null}),this.history.find(".is-add-new").on("click",function(o){var e=t.getColorObject().rgba,r=!1;if(t.history.find(".is-empty").length())t.history.find(".is-empty").each(function(o){var s=n.TsDom.select(o);t.history.find('[data-history-color="'+e+'"]').length()&&(r=!0),s.data("history-color")||r||(r=!0,s.css("background",e).attr("data-history-color",e).removeClass("is-empty").addClass("has-color"))});else if(!t.history.find('[data-history-color="'+e+'"]').length()){var s=n.TsDom.create("div").addClass("colorpicker-default__history-item").addClass("has-color").css("background",e).attr("data-history-color",e);t.history.append(s)}}),this.history.on("click",function(o){var e=n.TsDom.select(o.target);if(e.hasClass("has-color")){var r=e.data("history-color");t.setColor(r)}}),this.picker.on("contextmenu",function(t){return t.stopPropagation(),t.preventDefault(),!1})},o.prototype.onChangeInputValue=function(t){var o=+t.val();o>=0&&o<=255&&(this.spectrumColor=i.Color.process(this.getColorFromInputs()),this.setHueCursorPosition(),this.fillSpectrumCanvas(),this.fillOpacityCanvas(),this.spectrumColor=this.setSpectrumCursorPositionByColor(this.spectrumColor),this.hexInput.val(this.spectrumColor.hex),this.setOpacityGradientAndCursorColor(),this.dispatchColorChangedEvent())},o.prototype.getColorFromInputs=function(){return"rgba("+this.rInput.val()+", "+this.gInput.val()+", "+this.bInput.val()+", "+this.aInput.val()+")"},o.prototype.getCursorCoords=function(t){return{shiftX:t.offset().left+Math.floor(t.width()/2),shiftY:t.offset().top+Math.floor(t.height()/2)}},o.prototype.setOpacityGradientAndCursorColor=function(){var t=+this.aInput.val(),o=+(this.opacityCanvas.height()*t).toFixed(0)-this.opacityCursor.height()/2,e=this.opacityCanvas.width()/2-this.opacityCursor.width()/2;this.fillOpacityCanvas(),this.setCursorColorFromCursorPosition(this.opacityCursor,this.opacityCanvas,e,o,t)},o.prototype.initDragObject=function(t,o,e){if(t.stopPropagation(),t.preventDefault(),1==t.which){var r=t.clientX-e.position().left-Math.floor(o.width()/2),s=t.clientY-e.position().top-Math.floor(o.height()/2);this.dragObject={elements:{cursor:o,canvas:e},downX:t.clientX,downY:t.clientY,shiftX:r,shiftY:s,processShiftX:!0,processShiftY:!0}}},o.prototype.update=function(){this.options.color||(this.options.color=this.options.defaultColor),i.Color.process(this.options.color).isValid()&&this.processUpdate()},o.prototype.processUpdate=function(){this.spectrumColor=i.Color.process(this.options.color),this.currentColor=i.Color.process(this.options.color),this.aInput.val(this.spectrumColor.source.rgba.a),this.setColorValuesToInputs(),this.spectrumCanvas.attr("width",this.spectrumCanvas.width()).attr("height",this.spectrumCanvas.height()),this.spectrumCanvas.get().getContext("2d").clearRect(0,0,this.spectrumCanvas.width(),this.spectrumCanvas.height()),this.hueCanvas.attr("width",this.hueCanvas.width()).attr("height",this.hueCanvas.height()),this.opacityCanvas.attr("width",this.opacityCanvas.width()).attr("height",this.opacityCanvas.height()),this.fillHueCanvas(),this.setHueCursorPosition(),this.fillSpectrumCanvas(),this.fillOpacityCanvas(),this.setSpectrumCursorPositionByColor(this.spectrumColor),this.setOpacityCursorPosition(this.spectrumColor.source.rgba.a)},o.prototype.getColor=function(){var t=this.spectrumColor?i.Color.process(this.getColorFromInputs()):i.Color.process(this.options.color);return this.aInput.val()&&t.setOpacity(this.aInput.val()),t.format(this.options.format)},o.prototype.getColorObject=function(){return this.spectrumColor?i.Color.process(this.getColorFromInputs()):i.Color.process(this.options.color)},o.prototype.setSpectrumCursorPositionByColor=function(t){for(var o=this.spectrumCanvas.width(),e=this.spectrumCanvas.height(),r=this.spectrumCanvas.get().getContext("2d").getImageData(0,0,o,e).data,s=[],i=0,n=0,a=0;a<e;a++)for(var c=0;c<o;c++){var h=4*(a*o+c);s.push({r:r[h],g:r[h+1],b:r[h+2]})}for(var l,p=Number.MAX_SAFE_INTEGER,u=0;u<s.length;u++){var d=Math.sqrt(Math.pow(t.source.rgba.r-s[u].r,2)+Math.pow(t.source.rgba.g-s[u].g,2)+Math.pow(t.source.rgba.b-s[u].b,2));d<p&&(p=d,l=s[u])}for(a=0;a<e;a++)for(c=0;c<o;c++){h=4*(a*o+c);if(l.r===r[h]&&l.g===r[h+1]&&l.b===r[h+2]){n=a,i=c;break}}return i-=this.spectrumCursor.width()/2,n-=this.spectrumCursor.height()/2,this.processCursorPosition(this.spectrumCursor,this.spectrumCanvas,i,n),this.setCursorColorFromCursorPosition(this.spectrumCursor,this.spectrumCanvas,i,n)},o.prototype.setHueCursorPosition=function(){for(var t=this,o=this.picker.find(".colorpicker-default__hue-canvas"),e=0,r=Number.MAX_SAFE_INTEGER,s="",n=0;n<this.options.hueColors.length;n++){var a=i.Color.process(this.options.hueColors[n].color),c=Math.sqrt(Math.pow(this.spectrumColor.source.rgba.r-a.source.rgba.r,2)+Math.pow(this.spectrumColor.source.rgba.g-a.source.rgba.g,2)+Math.pow(this.spectrumColor.source.rgba.b-a.source.rgba.b,2));c<r&&(r=c,s=a.hex)}this.options.hueColors.forEach(function(o){o.color===s&&(t.hueColor=i.Color.process(o.color),e=Math.ceil(t.hueCanvas.height()*o.offset))});var h=this.picker.find(".colorpicker-default__hue-cursor"),l=Math.ceil(o.width()/2)-Math.ceil(h.width()/2);return this.processCursorPosition(h,o,l,e),this.setCursorColorFromCursorPosition(h,o,l,e)},o.prototype.setOpacityCursorPosition=function(t){var o=+(this.opacityCanvas.height()*t).toFixed(0);o-=this.opacityCursor.height()/2;var e=Math.ceil(this.opacityCanvas.width()/2)-Math.ceil(this.opacityCursor.width()/2);return this.processCursorPosition(this.opacityCursor,this.opacityCanvas,e,o),this.setCursorColorFromCursorPosition(this.opacityCursor,this.opacityCanvas,e,o,+this.aInput.val())},o.prototype.fillSpectrumCanvas=function(){var t=this.spectrumCanvas.width(),o=this.spectrumCanvas.height(),e=this.spectrumCanvas.get().getContext("2d");e.clearRect(0,0,t,o);var r=e.createLinearGradient(0,0,t,0);r.addColorStop(0,"#fff"),r.addColorStop(.01,"#fff"),r.addColorStop(.99,this.hueColor.rgb),r.addColorStop(1,this.hueColor.rgb),e.fillStyle=r,e.fillRect(0,0,t,o);var s=e.createLinearGradient(0,0,0,o);s.addColorStop(.01,"transparent"),s.addColorStop(.99,"#000"),s.addColorStop(1,"#000"),e.fillStyle=s,e.fillRect(0,0,t,o)},o.prototype.fillHueCanvas=function(){var t=this.hueCanvas.get().getContext("2d"),o=t.createLinearGradient(0,0,0,this.hueCanvas.height());this.options.hueColors.forEach(function(t){o.addColorStop(t.offset,t.color)}),t.fillStyle=o,t.fillRect(0,0,this.hueCanvas.width(),this.hueCanvas.height())},o.prototype.fillOpacityCanvas=function(){var t=this.opacityCanvas.get().getContext("2d");t.clearRect(0,0,this.opacityCanvas.width(),this.opacityCanvas.height());var o=t.createLinearGradient(0,0,0,this.opacityCanvas.height());o.addColorStop(0,"transparent"),o.addColorStop(1,this.spectrumColor.rgb),t.fillStyle=o,t.fillRect(0,0,this.opacityCanvas.width(),this.opacityCanvas.height())},o.prototype.setCursorColorFromCursorPosition=function(t,o,e,r,s){void 0===s&&(s=1);var n=o.get().getContext("2d"),a=Math.ceil(t.width()/2)+e,c=Math.ceil(t.height()/2)+r;(a<=0||0===e)&&(a=0),(c<=0||0===r)&&(c=0),a>=o.width()&&(a=o.width()-1),c>=o.height()&&(c=o.height()-1);var h=n.getImageData(a,c,1,1).data;0==a&&0==c&&console.log(h);var l="rgba("+h[0]+", "+h[1]+", "+h[2]+", "+s+")",p=i.Color.process(l);return t.css("background-color",p.rgba),p},o.prototype.dispatchColorChangedEvent=function(){n.TsDom.select(this.cssId).trigger("colorpicker:color-change",{color:this.getColor().toString()})},o.prototype.processCursorPosition=function(t,o,e,r,s,i){if(void 0===s&&(s=!0),void 0===i&&(i=!0),s){var n=t.width()/2;e+n<0&&e<=-n&&(e=-n),e>o.width()-n&&(e=o.width()-n)}else e=Math.ceil(o.width()/2)-Math.ceil(t.width()/2);if(i){var a=t.height()/2;r+a<0&&r<=-a&&(r=-a),r>o.height()-a&&(r=o.height()-a)}else r=Math.ceil(o.height()/2)-Math.ceil(t.height()/2);t.css("left",e+"px"),t.css("top",r+"px")},o.prototype.changeAInputValue=function(t){var o=+(t/this.opacityCanvas.height()).toFixed(2);o<=0?o=0:o>=1&&(o=1),this.aInput.val(o)},o.prototype.setColorValuesToInputs=function(){var t=this.spectrumColor,o=t.hex,e=t.source.rgba;this.hexInput.val(o),this.rInput.val(e.r),this.gInput.val(e.g),this.bInput.val(e.b)},o.prototype.getPickerCssClassName=function(){return"colorpicker-default"},o.prototype.getDefaultOptions=function(){return{defaultColor:"#f00",hueColors:[{offset:0,color:"#ff0000"},{offset:.17,color:"#ff00ff"},{offset:.33,color:"#0000ff"},{offset:.5,color:"#00ffff"},{offset:.67,color:"#00ff00"},{offset:.83,color:"#ffff00"},{offset:1,color:"#ff0000"}]}},o}(s.ColorPicker);t.exports=a}])});